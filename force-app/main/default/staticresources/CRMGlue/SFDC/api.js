define(["integration","lightning"],function(a,b){var c=!1,d=function(a){c=a},e=function(){return c},f=function(b){console.log("SFDC/api: addEventListener"),c||a.console.addEventListener("CTIEvent",b),a.eventListener=b},g=function(b){a.eventListener({message:JSON.stringify(b)})},h=function(b,d){if(console.log("SFDC/api: closeTab"),c){var e={success:!1};d&&d(e)}else a.console.closeTab(b,d)},i=function(b){console.log("SFDC/api: enableClickToDial"),c?a.opencti.enableClickToDial({callback:b}):a.interaction.cti.enableClickToDial(b)},j=function(b,d,e){console.log("SFDC/api: fireEvent"),c||a.console.fireEvent(b,d,e)},k=function(b,d){console.log("SFDC/api: focusPrimaryTabById "+b),c||a.console.focusPrimaryTabById(b,d)},l=function(b){if(console.log("SFDC/api: getFocusedPrimaryTabId"),c){var d={success:!1};b&&b(d)}else a.console.getFocusedPrimaryTabId(b)},m=function(b){console.log("SFDC/api: onClickToDial"),c?a.opencti.onClickToDial({listener:b}):a.interaction.cti.onClickToDial(b)},n=function(b){console.log("SFDC/api: onFocusedPrimaryTab"),c||a.console.onFocusedPrimaryTab(b)},o=function(b,d,e,f,g,h){if(console.log("SFDC/api: openPrimaryTab "+d),c){var i={success:!0};a.opencti.screenPop({type:a.opencti.SCREENPOP_TYPE.URL,params:{url:d}}),g&&g(i)}else a.console.openPrimaryTab(b,d,e,f,g,h)},p=function(b,d,e,f,g,h,i){if(console.log("SFDC/api: openSubtab "+d),c){var j={success:!0};a.opencti.screenPop({type:a.opencti.SCREENPOP_TYPE.URL,params:{url:d}}),h&&h(j)}else a.console.openSubtab(b,d,e,f,g,h,i)},q=function(b,d,e,f){if(console.log("SFDC/api: refreshPrimaryTabByName "+b),c){var g={success:!1};setTimeout(function(){a.opencti.refreshView()},1e3),e&&e(g)}else a.console.refreshPrimaryTabByName(b,d,e,f)},r=function(b,d,e,f){if(console.log("SFDC/api: refreshPrimaryTabById "+b),c){var g={success:!1};setTimeout(function(){a.opencti.refreshView()},1e3),e&&e(g)}else a.console.refreshPrimaryTabById(b,d,e,f)},s=function(b){console.log("SFDC/api: setSoftphoneLabel"),c?a.opencti.setSoftphoneItemLabel({label:b}):a.console.setCustomConsoleComponentButtonText(b)},t=function(b){switch(console.log("SFDC/api: setSoftphoneStyle"),b){case"connecting":c?a.opencti.setSoftphoneItemIcon({key:"sync"}):(a.console.setCustomConsoleComponentButtonStyle("background: black;"),a.console.setCustomConsoleComponentButtonStyle("color: white;"));break;case"connected":c?a.opencti.setSoftphoneItemIcon({key:"success"}):(a.console.setCustomConsoleComponentButtonStyle("background:#3bff3b;"),a.console.setCustomConsoleComponentButtonStyle("color:black;"));break;case"not connected":c?a.opencti.setSoftphoneItemIcon({key:"warning"}):(a.console.setCustomConsoleComponentButtonStyle("color:black;"),a.console.setCustomConsoleComponentButtonStyle("background:#ff3b3b;"))}},u=[];return{initialize:d,isLightning:e,addEventListener:f,sendEvent:g,closeTab:h,enableClickToDial:i,fireEvent:j,focusPrimaryTabById:k,getFocusedPrimaryTabId:l,onClickToDial:m,onFocusedPrimaryTab:n,openPrimaryTab:o,openSubtab:p,refreshPrimaryTabById:r,refreshPrimaryTabByName:q,setSoftphoneLabel:s,setSoftphoneStyle:t,fireOnCallBegin:function(b,d){console.log("SFDC/api: fireOnCallBegin - "+d),u.push(b.id),c||a.console.cti.setCallObjectIds(u)},fireOnCallEnd:function(b,d,e){console.log("SFDC/api: fireOnCallEnd");var f=u.indexOf(b.id);f>-1&&u.splice(f,1),c||a.console.cti.setCallObjectIds(u)},setCallAttachedData:function(b){c||a.console.cti.setCallAttachedData(b.id,JSON.stringify(b.userData),b.callType&&"Outbound"===b.callType?"outbound":"inbound")}}});