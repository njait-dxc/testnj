define(["util","config","agent/comms"],function(a,b,c){var d="agent/voice: ";return{onMessage:function(b){console.log(d+b.messageType);try{if("CallStateChangeMessage"===b.messageType&&"StatusChange"===b.notificationType)switch(console.log(d+"id - "+b.call.id),console.log(d+"state - "+b.call.state),console.log(d+"call type - "+b.call.callType),b.call.mediaType="voice"+b.call.callType,void 0!==b.call.dnis&&console.log(d+"dnis - "+b.call.dnis),b.call.state){case"Established":console.log(d+"publish voice.pop"),a.getInstance("voice.pop").publish(b);break;case"Completed":console.log(d+"publish voice.ended"),a.getInstance("voice.ended").publish(b)}}catch(a){console.error(d+"ERROR - "+a.stack)}},dial:function(a){console.log(d+"dial - "+a.phoneNumber);var e={action:"Dial",CI:b.CI,actionData:{number:a.phoneNumber,userData:a.userData}};c.send(e,a.callback,a.error)}}});