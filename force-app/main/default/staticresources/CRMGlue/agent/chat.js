define(["util","moment","config"],function(a,b,c){return{onMessage:function(b){console.log("agent/chat: "+b.messageType);try{if("ChatStateChangeMessage"===b.messageType&&"StatusChange"===b.notificationType)switch(console.log("agent/chat: id - "+b.chat.id),console.log("agent/chat: state - "+b.chat.state),b.chat.mediaType="chat",b.chat.state){case"Chatting":console.log("agent/chat: publish chat.pop"),a.getInstance("chat.pop").publish(b);break;case"Completed":console.log("agent/chat: publish chat.ended"),a.getInstance("chat.ended").publish(b)}}catch(a){console.error("agent/chat: ERROR - "+a.stack)}}}});